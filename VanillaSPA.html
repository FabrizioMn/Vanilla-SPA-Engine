<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Router-Manual</title>
    <style>
        body {
            font-family: 'Segoe UI';
            transition: background-color 0.3s ease, color 0.3s ease;
        }
        body.dark {
            background-color: #1a1a1a;
            color: #ffffff;

            nav a{
              color: #fff;
            }
        }
        body.dark li {
            background-color: #333 !important;
            box-shadow: 0px 0px 1px 2px #444 !important;
        }

        #root{
          text-align: center;
          user-select: none;




          div{
            user-select: none;
            input{
              background-color: #ccc;
              border:none;
              outline:none;
              font-size: 20px;
              border-radius: 4px;
            }


            button{
              padding: 5px 8px;
              border:none;
              background-color: #ccc;
              border-radius: 7px;
              font-weight: 600;
              transition: transform 0.2s;
            }

            button:active{
              transform: scale(0.9);
            }


          }
        }

        nav{
          display: flex;
          gap: 20px;
          justify-content: center;
          align-items: center;
          user-select: none;


          a{
            list-style: none;
            text-decoration: none;
            color:#1a1a1a;
            font-weight: 600;
            transition: transform 0.2s;
            
          }

          a:hover{
            transform: scale(1.1);
          }
          a:active{
            transform: scale(0.9);
          }

          button{
            padding: 5px 8px;
            border:none;
            background-color: #ccc;
            border-radius: 7px;
            font-weight: 600;
            transition: transform 0.2s;
          }
          button:active{
            transform: scale(0.9);
          }
        }

        

    </style>
  </head>
  <body>
    <nav id="nav">
      <a href="#" class="nav-link" data-route="home">Home</a>
      <a href="#" class="nav-link" data-route="proyectos">Proyectos</a>
    </nav>

    <div id="root"></div>

    <script>
      const temaGuardado=localStorage.getItem("tema");
      if(temaGuardado==="oscuro"){document.body.classList.add("dark")};
      
      //---------------------------------------------------------------------

      const root = document.getElementById("root");
      const enlaces = document.querySelectorAll(".nav-link");
      const contenido = {
        home: "<h1>Pagina de Inicio</h1>",
        proyectos: renderizarProyectos
      };


      //---------------------------------------------------------------------
      const boton=document.createElement("button");
      const navBar=document.getElementById("nav")
      boton.textContent="Cambiar modoðŸŒ‘"
      nav.appendChild(boton);      
      boton.addEventListener("click",()=>{
        document.body.classList.toggle("dark");
        const isDark=document.body.classList.contains("dark");
        localStorage.setItem("tema",isDark ? "oscuro" : "claro");
        if(isDark ? boton.textContent="Modo Claro â˜€" : boton.textContent="Modo Oscuro ðŸŒ‘");
      })

      //---------------------------------------------------------------------

      async function obtenerProyectos(){
          const respuesta = await fetch("https://jsonplaceholder.typicode.com/posts");
          const datos = await respuesta.json();

          const listaHTML = datos.slice(0, 5).map((post) => `<li>${post.title}</li>`).join("");

          return `<h1>Mis Proyectos</h1><ul>${listaHTML}</ul>`;
      }
      
      //---------------------------------------------------------------------
      const navegar = async (ruta) => {
        const rutaLimpia = ruta.replace("#", "") || "home";
        
        if (typeof contenido[rutaLimpia] === "function") {
          await contenido[rutaLimpia]();
        } else {
          root.innerHTML = contenido[rutaLimpia];
        }
      };
      //---------------------------------------------------------------------
      
      enlaces.forEach((link) => {
        link.addEventListener("click", (e) => {
          e.preventDefault();
          history.pushState({}, "", "/#" + link.dataset.route);
          navegar(link.dataset.route);
        });
      });

      window.addEventListener("popstate", () => {
        navegar(location.hash);
      });
      navegar(location.hash);

      //---------------------------------------------------------------------
      async function renderizarProyectos(){
        root.innerHTML="";
        const formulario=crearFormulario();
        root.appendChild(formulario);
        
        if(localStorage.getItem("proyectos")!==null){
          const dataAlmacenada=localStorage.getItem("proyectos");
          const data=JSON.parse(dataAlmacenada);
          root.appendChild(crearItems(data));
          
        } else{
          const peticion=await fetch("https://jsonplaceholder.typicode.com/posts");
          const datos= await peticion.json();
          localStorage.setItem("proyectos",JSON.stringify(datos));
          root.appendChild(crearItems(datos));
        }
        
        function crearItems(datos){
          const listaElementos=document.createElement("ul");
          datos.forEach((link)=>{
            const li=document.createElement("li");
            const boton=document.createElement("button");
            const titulo=document.createElement("span");
            titulo.textContent=link.title;
            boton.textContent="X";
            Object.assign(li.style,{
              backgroundColor:"#f9f9f9",
              padding:"10px",
              margin:"10px 0",
              display:"flex",
              justifyContent:"space-between",
              alignItem:"center",
              borderRadius:"8px",
              boxShadow:"0px 0px 1px 2px #ddd"
            });
            Object.assign(boton.style,{
              backgroundColor:"red",
              color:"white",
              padding:"7px 10px",
              borderRadius:"100%",
              border:"none",

            })
            
            li.appendChild(titulo);
            li.appendChild(boton);
            boton.addEventListener("click",()=>{
              li.remove();
              const datosActuales = JSON.parse(localStorage.getItem("proyectos"));
              const nuevosDatos=datosActuales.filter((p)=>p.id !== link.id);
              localStorage.setItem("proyectos",JSON.stringify(nuevosDatos));
            });
            listaElementos.appendChild(li);
          });
          return listaElementos;
        }
        
        function crearFormulario(){
          const input=document.createElement("input");
          const boton=document.createElement("button");
          const div=document.createElement("div");
          boton.textContent="Agregar";
          div.appendChild(input);
          div.appendChild(boton);

          Object.assign(div.style,{
            padding:"20px",
            display:"flex",
            justifyContent:"center",
            gap:"15px"
          })

          input.addEventListener("keypress",(e)=>{
            if(e.key==="Enter"){
              e.preventDefault();
              newDato(input);
            }
          })
          
          boton.addEventListener("click",(e)=>{
            if(input.value!==""){
              e.preventDefault();
              newDato(input);
              
            }else {
              alert("ESCRIBE ALGO SI QUIERES AGREGAR!")
            }
          });

          
          
          return div;
          
        }
        
        function newDato(input){
          const nuevoPost={id:Date.now(),title:input.value};
          const data=localStorage.getItem("proyectos");
          const proyectos=JSON.parse(data) || [];
          proyectos.push(nuevoPost);
          input.value="";
          localStorage.setItem("proyectos",JSON.stringify(proyectos));
          actualizarLista();
        }
        
        function actualizarLista(){
          const datosActuales=localStorage.getItem("proyectos");
          const data=JSON.parse(datosActuales);

          const listaExistente=root.querySelector("ul");
          if(listaExistente){
            root.removeChild(listaExistente);
          }
          root.appendChild(crearItems(data));
        }
        
      }
      </script>
  </body>
  </html>
